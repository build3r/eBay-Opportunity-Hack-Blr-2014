<html>
<head>
    <meta charset="utf-8">
    <title>Corgi: A new Bootstrap Theme</title>
    <meta name="description" content="A new bootstrap theme">
    <meta name="author" content="Damian Sowers">
    <!-- Le styles -->
    <link href="http://www.3solarmasses.com/corgi-bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Raleway:400,600" rel="stylesheet" type="text/css">
    <link href="http://www.3solarmasses.com/corgi-bootstrap/css/corgi.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="http://www.3solarmasses.com/corgi-bootstrap/css/elusive-webfont.css">
    <script src="http://www.3solarmasses.com/corgi-bootstrap/js/jquery.min.js" type="text/javascript"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script> 

 <script src="http://www.3solarmasses.com/corgi-bootstrap/js/bootstrap.js"></script>
    <script src="http://www.3solarmasses.com/corgi-bootstrap/js/corgi.js"></script>
    <!-- elusive icons ie7 support -->
    <!--[if lte IE 7]><script src="js/lte-ie7.js"></script><![endif]-->

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
    <![endif]-->
   
  </head>
  
  <style>
      body {
        padding-top: 80px; /* Only include this for the fixed top bar */
      }
    </style>
<body>
	<div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <div>
		<button id="#addtask" onclick="addtaskFun()" > Add Task </button>
		<input type='textbox' id='textinput' ></input>
		<button id="#add" onclick="addtask()" > Add </button>
		<p id="adminwarning" style = "color : red;"> Only Admin can Edit or Delete the Post </p> 
	</div>
          
          
        </div>
      </div>
    </div>

	
	<div class="span8" >
          <div class="corgi_feed_well" id="post_div1">
            <div class="feed_stacked">
              <div class="feed_item">
                <div class="feed_body">
                  <div class="row">
                    <div class="feed_profile_pic">
                      <img src="http://fc09.deviantart.net/fs70/f/2012/345/f/8/ebay___icon_by_darhymes-d5nq1mg.png" alt="meta image" class="meta_image">
                    </div>
                    <div class="feed_text" id="post_text1">
                      this is first post..
                    </div>
                  </div>
                </div>
                <div class="comment_area">
                  <p>Add a comment</p>
                  <form>
                    <textarea rows="3" class="span6"></textarea><br>
                    <input type="submit" class="btn">
                  </form>
                </div>
                <hr class="feed_hr">
                <div class="bottom_meta">
                  <div class="row">
                    <div class="bottom_right">
                    	<span> <a href="#" onclick="editpost(1)"> Edit </a> </span> 
                    	<span> <a href="#" onclick="deletepost(1)"> Delete </a> </span> 
                   <span>  <a href="#" class="show_comment_link">Comment</a> </span>
                    </div> 
                  </div>
                </div>
              </div>
            </div>
        </div>
    

     <div class="corgi_feed_well" id="post_div2">
            <div class="feed_stacked">
              <div class="feed_item">
                <div class="feed_body">
                  <div class="row">
                    <div class="feed_profile_pic">
                      <img src="http://fc09.deviantart.net/fs70/f/2012/345/f/8/ebay___icon_by_darhymes-d5nq1mg.png" alt="meta image" class="meta_image">
                    </div>
                    <div class="feed_text" id="post_text2">
                      This is second post.
                    </div>
                  </div>
                </div>
                <div class="comment_area">
                  <p>Add a comment</p>
                  <form>
                    <textarea rows="3" class="span6"></textarea><br>
                    <input type="submit" class="btn">
                  </form>
                </div>
                <hr class="feed_hr">
                <div class="bottom_meta">
                  <div class="row">
                    <div class="bottom_right">
                    	<span> <a href="#" onclick="editpost(2)"> Edit </a> </span> 
                    	<span> <a href="#" onclick="deletepost(2)"> Delete </a> </span> 
                   <span>  <a href="#" class="show_comment_link">Comment</a> </span>
                    </div> 
                  </div>
                </div>
              </div>
            </div>
        </div>

      

      <div class="corgi_feed_well" id="post_div3">
            <div class="feed_stacked">
              <div class="feed_item">
                <div class="feed_body">
                  <div class="row">
                    <div class="feed_profile_pic">
                      <img src="http://fc09.deviantart.net/fs70/f/2012/345/f/8/ebay___icon_by_darhymes-d5nq1mg.png" alt="meta image" class="meta_image">
                    </div>
                    <div class="feed_text" id="post_text3">
                      This is third post.
                    </div>
                  </div>
                </div>
                <div class="comment_area">
                  <p>Add a comment</p>
                  <form>
                    <textarea rows="3" class="span6"></textarea><br>
                    <input type="submit" class="btn">
                  </form>
                </div>
                <hr class="feed_hr">
                <div class="bottom_meta">
                  <div class="row">
                    <div class="bottom_right">
                    	<span> <a href="#" onclick="editpost(3)"> Edit </a> </span> 
                    	<span> <a href="#" onclick="deletepost(3)"> Delete </a> </span> 
                   <span>  <a href="#" class="show_comment_link">Comment</a> </span>
                    </div> 
                  </div>
                </div>
              </div>
            </div>
        </div>

     

<div class="corgi_feed_well" id="post_div4">
            <div class="feed_stacked">
              <div class="feed_item">
                <div class="feed_body">
                  <div class="row">
                    <div class="feed_profile_pic">
                      <img src="http://fc09.deviantart.net/fs70/f/2012/345/f/8/ebay___icon_by_darhymes-d5nq1mg.png" alt="meta image" class="meta_image">
                    </div>
                    <div class="feed_text" id="post_text4">
                      This is fourth post.
                    </div>
                  </div>
                </div>
                <div class="comment_area">
                  <p>Add a comment</p>
                  <form>
                    <textarea rows="3" class="span6"></textarea><br>
                    <input type="submit" class="btn">
                  </form>
                </div>
                <hr class="feed_hr">
                <div class="bottom_meta">
                  <div class="row">
                    <div class="bottom_right">
                    	<span> <a href="#" onclick="editpost(4)"> Edit </a> </span> 
                    	<span> <a href="#" onclick="deletepost(4)"> Delete </a> </span> 
                   <span>  <a href="#" class="show_comment_link">Comment</a> </span>
                    </div> 
                  </div>
                </div>
              </div>
            </div>
        </div>


<div class="corgi_feed_well" id="post_div5">
            <div class="feed_stacked">
              <div class="feed_item">
                <div class="feed_body">
                  <div class="row">
                    <div class="feed_profile_pic">
                      <img src="http://fc09.deviantart.net/fs70/f/2012/345/f/8/ebay___icon_by_darhymes-d5nq1mg.png" alt="meta image" class="meta_image">
                    </div>
                    <div class="feed_text" id="post_text5">
                      This is fourth post.
                    </div>
                  </div>
                </div>
                <div class="comment_area">
                  <p>Add a comment</p>
                  <form>
                    <textarea rows="3" class="span6"></textarea><br>
                    <input type="submit" class="btn">
                  </form>
                </div>
                <hr class="feed_hr">
                <div class="bottom_meta">
                  <div class="row">
                    <div class="bottom_right">
                    	<span> <a href="#" onclick="editpost(5)"> Edit </a> </span> 
                    	<span> <a href="#" onclick="deletepost(5)"> Delete </a> </span> 
                   <span>  <a href="#" class="show_comment_link">Comment</a> </span>
                    </div> 
                  </div>
                </div>
              </div>
            </div>
        </div>


<div class="corgi_feed_well" id="post_div6">
            <div class="feed_stacked">
              <div class="feed_item">
                <div class="feed_body">
                  <div class="row">
                    <div class="feed_profile_pic">
                      <img src="http://fc09.deviantart.net/fs70/f/2012/345/f/8/ebay___icon_by_darhymes-d5nq1mg.png" alt="meta image" class="meta_image">
                    </div>
                    <div class="feed_text" id="post_text6">
                      This is fourth post.
                    </div>
                  </div>
                </div>
                <div class="comment_area">
                  <p>Add a comment</p>
                  <form>
                    <textarea rows="3" class="span6"></textarea><br>
                    <input type="submit" class="btn">
                  </form>
                </div>
                <hr class="feed_hr">
                <div class="bottom_meta">
                  <div class="row">
                    <div class="bottom_right">
                    	<span> <a href="#" onclick="editpost(6)"> Edit </a> </span> 
                    	<span> <a href="#" onclick="deletepost(6)"> Delete </a> </span> 
                   <span>  <a href="#" class="show_comment_link">Comment</a> </span>
                    </div> 
                  </div>
                </div>
              </div>
            </div>
        </div>

      </div>
      
    <script>

    var global_post = 1;
    ajax_populate();

	function addtask(){
		var cont = "new addition", ss1="education", ss2 = "-", ss3= "-", suname = "nee" , scity= "Bangalore" ;
		var data = $("#textinput").val();
		console.log(data);
		$.ajax({ url: 'http://192.168.113.68:8000/add_activity',
         type: 'POST',
         data: { content: data, s1: ss1, s2 : ss2, s3 : ss3, uname : suname, city : scity },
         success: function(output) {
         	console.log("output success added"); 
         	ajax_populate();

                  }
});
	}

	function deletepost(index) {
		$.ajax({ url: 'http://192.168.113.68:8000/del_activity',
         type: 'POST',
         data: { pid: index  },
         success: function(output) {
         	ajax_populate();
         	console.log("output success deleted");        	
                  },
                  error: function( output ){
           	$("#adminwarning").show();
           }

});

	}
    function update_post(index, data){

    		var str = "#post_div"+index ;
    		var post1 = "#post_text" + index;
    		console.log(" post data", data);
    		console.log("showing for "+ str);
    		$(post1).text(data);

    		$(str).show();
    	
    }


function addtaskFun(){
 ajax_populate();
}



function editpost(index, cont){
	cont = $("#textinput").val();
	if(cont ==null) {
		cont= "default";
	}
	console.log("view edit ", index, cont);

$.ajax({ url: 'http://192.168.113.68:8000/edit_activity',
         type: 'POST',
         data: {pid : index, content: cont },
         success: function(output) {
         	ajax_populate();
         	console.log("output success edit");        	
                  },
           error: function( output ){
           	$("#adminwarning").show();
           }
});

}



function ajax_populate() {
	clearPost();
$.ajax({ url: 'http://192.168.113.68:8000/list_act',
         type: 'get',

         success: function(output) {
         	console.log("output success");
         	console.log(output.len);
         	global_post = output.len;
         	for(var i=0; i< output.len ; i++) {
         		console.log(output.data[i].content, output.data[i].pid);
         		update_post(output.data[i].pid, output.data[i].content );

         	}
         	
                  }
});


}

    function clearPost(){
     console.log("clearing post");
     $("#adminwarning").hide();
     $("#post_div1").hide();
  	$("#post_div2").hide();
  	$("#post_div3").hide();
  	$("#post_div4").hide();
  	$("#post_div5").hide();
  	$("#post_div6").hide();
  }

  clearPost();
 

  </script>
     </body>
     </html>